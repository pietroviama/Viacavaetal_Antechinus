SC34<-as.integer(175)
SC35<-as.integer(176)
SC36<-as.integer(177)
SC37<-as.integer(178)
SC38<-as.integer(c(179:180))
SC39<-as.integer(c(181:182))
SC40<-as.integer(c(183:187))
SC41<-as.integer(c(188:190))
SC42<-as.integer(c(191:193))
SC43<-as.integer(c(194:197))
SC44<-as.integer(c(198:201))
SC45<-as.integer(c(202:205))
SC46<-as.integer(c(206:209))
SC47<-as.integer(c(210:212))
SC48<-as.integer(c(213:215))
SC49<-as.integer(c(216:218))
SC50<-as.integer(c(219:223))
SC51<-as.integer(c(224:226))
SC52<-as.integer(c(227:231))
SC53<-as.integer(232)
SC54<-as.integer(233)
SC55<-as.integer(c(234:238))
SC56<-as.integer(c(239:243))
SC57<-as.integer(c(244:245))
SC58<-as.integer(c(246:247))
SC59<-as.integer(c(248:250))
SC60<-as.integer(c(251:253))
SC61<-as.integer(c(254:256))
SC62<-as.integer(c(257:264))
SC63<-as.integer(c(265:267))
# Creation d'une liste de toutes les courbes, incluant les lm anatomiques bordant les courbes
curves<-list(SC1,SC2,SC3,SC4,SC5,SC6,SC7,SC8,SC9,SC10,SC11,SC12,SC13,SC14,SC15,SC16,SC17,SC18,SC19,SC20,
SC21,SC22,SC23,SC24,SC25,SC26,SC27,SC28,SC29,SC30,SC31,SC32,SC33,SC34,SC35,SC36,SC37,SC38,SC39,SC40,SC41,SC42,SC43,SC44,SC45,SC46,SC47,SC48,SC49,SC50,SC51,SC52,SC53,SC54,SC55,SC56,SC57,SC58,SC59,SC60,SC61,SC62,SC63)
#Atlas plot and original plot to check if the landmark numbers remain in the same order
Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = curves)
#list(83, c(84:86), c(87:89), c(90:92), c(93:95), 96, c(97:104), c(105:107), c(108:110), c(111:113), c(114:116), c(117:120), c(121:124), c(125:127), c(128:130), c(131:132), c(133:134), c(135:136), c(137:138), c(139:143), c(144:148), c(149:151), c(152:153), c(154:157), c(158:159), 160, 161, 162, 163, c(164:166), c(167:168), c(169:172), c(173:174), 175, 176, 177, 178, c(179:180), c(181:182), c(183:187), c(188:190), c(191:193), c(194:197), c(198:201), c(202:205), c(206:209), c(210:212), c(213:215), c(216:218), c(219:223), c(224:226), c(227:231), 232, 233, c(234:238), c(239:243), c(244:245), c(246:247), c(248:250), c(251:253), c(254:256), c(257:264), c(265:267)
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE)
#This places the numbers of the landmarks as per the Atlas
#text3d(subtropicus.p1, texts = c(1:412), asp=FALSE, cex=2, col="blue", pos = 3 )
#testmesh <- file2mesh('3Dmodels/Asubtropicus/JM213.ply',readcol=T,clean=T)
#open3d()
#plotspec(testmesh, lmplacement[,,1], ptsize = 0.1  )
#text3d(lmplacement[,,1], texts = c(1:412), asp=FALSE, cex=1, col="blue", pos = 3 )
### 4th step apply the template to all the other specimens, remember to play with inflate/deflate
#Atlas plot and original plot to check if the landmark numbers remain in the same order
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE)
#Atlas plot and original plot to check if the landmark numbers remain in the same order
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE)
knitr::opts_knit$set(root.dir = 'C:/Users/pietro/Desktop/Pietro/Projects/Viacavaetal_Antechinus/Data', echo = TRUE)
library(Morpho)
library(rgl)
library(Rvcg)
library(geomorph)
setwd('C:/Users/pietro/Desktop/Pietro/Projects/Viacavaetal_Antechinus/Data')
## import meshes and points cloud
subtropicus.holo<-file2mesh('3Dmodels/Asubtropicus/J17407.ply',readcol=F,clean=T)
subtropicus.p<-(read.csv('Templatecoords.csv', header = F))
dim(subtropicus.p)
rownames(subtropicus.p)<-subtropicus.p$V1
subtropicus.p1 <- subtropicus.p[,-1]
#A <- arrayspecs(subtropicus.p1, 412, 3)
#dim(A)
#Ahead <- head(dimnames(A))[3]
#template.p<-A[,,1]
#antestspecs<-A[,,2:5]
shade3d(subtropicus.holo,col=8)
spheres3d(subtropicus.p1[1:82,],radius=0.3,col=1)#fixed. nb of landmark = (z-1)/3
spheres3d(subtropicus.p1[83:267,],radius=0.2,col=2) #curves
spheres3d(subtropicus.p1[268:412,],radius=0.1,col=3) #patches
text3d(subtropicus.p1, texts = c(1:412), asp=FALSE, cex=1, col="blue", pos = 3 )
LMcoords <- t(read.csv('Antechinus_cranialvariation_data.csv', header = T, row.names = 1))
dim(LMcoords)
Ants <- arrayspecs(LMcoords, 82, 3)
dim(Ants)
Ahead <- head(dimnames(Ants))[3]
fixed<-as.matrix(subtropicus.p1[1:82,])
patch<-as.matrix(subtropicus.p1[c(83:412),])
# Declaration of rowindices of curves
SC1<-as.integer(83)
#Atlas plot and original plot to check if the landmark numbers remain in the same order
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE)
Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = list(83, c(84:86), c(87:89), c(90:92), c(93:95), 96, c(97:104), c(105:107), c(108:110), c(111:113), c(114:116), c(117:120), c(121:124), c(125:127), c(128:130), c(131:132), c(133:134), c(135:136), c(137:138), c(139:143), c(144:148), c(149:151), c(152:153), c(154:157), c(158:159), 160, 161, 162, 163, c(164:166), c(167:168), c(169:172), c(173:174), 175, 176, 177, 178, c(179:180), c(181:182), c(183:187), c(188:190), c(191:193), c(194:197), c(198:201), c(202:205), c(206:209), c(210:212), c(213:215), c(216:218), c(219:223), c(224:226), c(227:231), 232, 233, c(234:238), c(239:243), c(244:245), c(246:247), c(248:250), c(251:253), c(254:256), c(257:264), c(265:267))
Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = list(83, c(84:86), c(87:89), c(90:92), c(93:95), 96, c(97:104), c(105:107), c(108:110), c(111:113), c(114:116), c(117:120), c(121:124), c(125:127), c(128:130), c(131:132), c(133:134), c(135:136), c(137:138), c(139:143), c(144:148), c(149:151), c(152:153), c(154:157), c(158:159), 160, 161, 162, 163, c(164:166), c(167:168), c(169:172), c(173:174), 175, 176, 177, 178, c(179:180), c(181:182), c(183:187), c(188:190), c(191:193), c(194:197), c(198:201), c(202:205), c(206:209), c(210:212), c(213:215), c(216:218), c(219:223), c(224:226), c(227:231), 232, 233, c(234:238), c(239:243), c(244:245), c(246:247), c(248:250), c(251:253), c(254:256), c(257:264), c(265:267)))
Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = list(as.integer(83, c(84:86), c(87:89), c(90:92), c(93:95), 96, c(97:104), c(105:107), c(108:110), c(111:113), c(114:116), c(117:120), c(121:124), c(125:127), c(128:130), c(131:132), c(133:134), c(135:136), c(137:138), c(139:143), c(144:148), c(149:151), c(152:153), c(154:157), c(158:159), 160, 161, 162, 163, c(164:166), c(167:168), c(169:172), c(173:174), 175, 176, 177, 178, c(179:180), c(181:182), c(183:187), c(188:190), c(191:193), c(194:197), c(198:201), c(202:205), c(206:209), c(210:212), c(213:215), c(216:218), c(219:223), c(224:226), c(227:231), 232, 233, c(234:238), c(239:243), c(244:245), c(246:247), c(248:250), c(251:253), c(254:256), c(257:264), c(265:267))))
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE)
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE)
?plotAtlas
cols<-c("pink", "purple", "yellow", "green")
cols<-c("pink", "purple", "yellow", "green")
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE, cols = cols)
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE, cols = cols)
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE, cols = cols)
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE)
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE, cols = cols)
#The below is code to take out a small subsample of the whole 3d array
Folder <- "C:/Users/pietro/Desktop/Pietro/Projects/Viacavaetal_Antechinus/Data/3Dmodels/AntechinusTest/"
#Navigate to folder with the subsample of ply files
Plylist <- sub(".ply", "", list.files(Folder))
matching <- match(dimnames(Ants)[[3]],Plylist)
for_patch_placing <-which (!is.na(matching)==TRUE)
#Make an array that includes only the specimens you have in your folder
data <-Ants[, , for_patch_placing]
dimnames(data)[[3]]
lmplacement<-placePatch(Atlas,data,path=Folder, inflate=1) #ray=TRUE for projection along surface normals instead of closest point
checkLM(lmplacement, path = Folder, atlas=Atlas)
lmplacement<-placePatch(Atlas,data,path=Folder, inflate=0) #ray=TRUE for projection along surface normals instead of closest point
match(dimnames(Ants)[[3]],Plylist)
#The below is code to take out a small subsample of the whole 3d array
Folder <- "C:/Users/pietro/Desktop/Pietro/Projects/Viacavaetal_Antechinus/Data/3Dmodels/AntechinusTest/"
#Navigate to folder with the subsample of ply files
Plylist <- sub(".ply", "", list.files(Folder))
match(dimnames(Ants)[[3]],Plylist)
matching <- match(dimnames(Ants)[[3]],Plylist)
for_patch_placing <-which (!is.na(matching)==TRUE)
#Make an array that includes only the specimens you have in your folder
data <-Ants[, , for_patch_placing]
dimnames(data)[[3]]
lmplacement<-placePatch(Atlas,data,path=Folder, inflate=0) #ray=TRUE for projection along surface normals instead of closest point
lmplacement<-placePatch(Atlas,data,path=Folder, inflate=10) #ray=TRUE for projection along surface normals instead of closest point
lmplacement<-placePatch(Atlas,data,path=Folder, inflate=3) #ray=TRUE for projection along surface normals instead of closest point
for_patch_placing
Plylist
dimnames(Ants)[[3]]
for_patch_placing <-which (!is.na(matching)==TRUE)
matching
## import meshes and points cloud
subtropicus.holo<-file2mesh('3Dmodels/Asubtropicus/J17407.ply',readcol=F,clean=T)
subtropicus.p<-(read.csv('Templatecoords.csv', header = F))
dim(subtropicus.p)
rownames(subtropicus.p)<-subtropicus.p$V1
subtropicus.p1 <- subtropicus.p[,-1]
#A <- arrayspecs(subtropicus.p1, 412, 3)
#dim(A)
#Ahead <- head(dimnames(A))[3]
#template.p<-A[,,1]
#antestspecs<-A[,,2:5]
shade3d(subtropicus.holo,col=8)
spheres3d(subtropicus.p1[1:82,],radius=0.3,col=1)#fixed. nb of landmark = (z-1)/3
spheres3d(subtropicus.p1[83:267,],radius=0.2,col=2) #curves
spheres3d(subtropicus.p1[268:412,],radius=0.1,col=3) #patches
text3d(subtropicus.p1, texts = c(1:412), asp=FALSE, cex=1, col="blue", pos = 3 )
LMcoords <- t(read.csv('Antechinus_cranialvariation_data.csv', header = T, row.names = 1))
dim(LMcoords)
Ants <- arrayspecs(LMcoords, 82, 3)
dim(Ants)
Ahead <- head(dimnames(Ants))[3]
fixed<-as.matrix(subtropicus.p1[1:82,])
patch<-as.matrix(subtropicus.p1[c(83:412),])
Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = list(as.integer(83, c(84:86), c(87:89), c(90:92), c(93:95), 96, c(97:104), c(105:107), c(108:110), c(111:113), c(114:116), c(117:120), c(121:124), c(125:127), c(128:130), c(131:132), c(133:134), c(135:136), c(137:138), c(139:143), c(144:148), c(149:151), c(152:153), c(154:157), c(158:159), 160, 161, 162, 163, c(164:166), c(167:168), c(169:172), c(173:174), 175, 176, 177, 178, c(179:180), c(181:182), c(183:187), c(188:190), c(191:193), c(194:197), c(198:201), c(202:205), c(206:209), c(210:212), c(213:215), c(216:218), c(219:223), c(224:226), c(227:231), 232, 233, c(234:238), c(239:243), c(244:245), c(246:247), c(248:250), c(251:253), c(254:256), c(257:264), c(265:267))))
Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = list(as.integer(83, c(84:86), c(87:89), c(90:92), c(93:95), 96, c(97:104), c(105:107), c(108:110), c(111:113), c(114:116), c(117:120), c(121:124), c(125:127), c(128:130), c(131:132), c(133:134), c(135:136), c(137:138), c(139:143), c(144:148), c(149:151), c(152:153), c(154:157), c(158:159), 160, 161, 162, 163, c(164:166), c(167:168), c(169:172), c(173:174), 175, 176, 177, 178, c(179:180), c(181:182), c(183:187), c(188:190), c(191:193), c(194:197), c(198:201), c(202:205), c(206:209), c(210:212), c(213:215), c(216:218), c(219:223), c(224:226), c(227:231), 232, 233, c(234:238), c(239:243), c(244:245), c(246:247), c(248:250), c(251:253), c(254:256), c(257:264), c(265:267))))
cols<-c("pink", "purple", "yellow", "green")
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE, cols = cols)
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE, cols = cols)
#The below is code to take out a small subsample of the whole 3d array
Folder <- "C:/Users/pietro/Desktop/Pietro/Projects/Viacavaetal_Antechinus/Data/3Dmodels/AntechinusTest/"
#Navigate to folder with the subsample of ply files
Plylist <- sub(".ply", "", list.files(Folder))
matching <- match(dimnames(Ants)[[3]],Plylist)
for_patch_placing <-which (!is.na(matching)==TRUE)
#Make an array that includes only the specimens you have in your folder
data <-Ants[, , for_patch_placing]
dimnames(data)[[3]]
lmplacement<-placePatch(Atlas,data,path=Folder, inflate=3) #ray=TRUE for projection along surface normals instead of closest point
#A <- arrayspecs(subtropicus.p1, 412, 3)
#dim(A)
#Ahead <- head(dimnames(A))[3]
#template.p<-A[,,1]
#antestspecs<-A[,,2:5]
shade3d(subtropicus.holo,col=8)
fixed<-as.matrix(subtropicus.p1[1:82,])
patch<-as.matrix(subtropicus.p1[c(83:267),])
knitr::opts_knit$set(root.dir = 'C:/Users/pietro/Desktop/Pietro/Projects/Viacavaetal_Antechinus/Data', echo = TRUE)
library(Morpho)
library(rgl)
library(Rvcg)
library(geomorph)
setwd('C:/Users/pietro/Desktop/Pietro/Projects/Viacavaetal_Antechinus/Data')
## import meshes and points cloud
subtropicus.holo<-file2mesh('3Dmodels/Asubtropicus/J17407.ply',readcol=F,clean=T)
subtropicus.p<-(read.csv('Templatecoords.csv', header = F))
dim(subtropicus.p)
rownames(subtropicus.p)<-subtropicus.p$V1
subtropicus.p1 <- subtropicus.p[,-1]
#A <- arrayspecs(subtropicus.p1, 412, 3)
#dim(A)
#Ahead <- head(dimnames(A))[3]
#template.p<-A[,,1]
#antestspecs<-A[,,2:5]
shade3d(subtropicus.holo,col=8)
spheres3d(subtropicus.p1[1:82,],radius=0.3,col=1)#fixed. nb of landmark = (z-1)/3
spheres3d(subtropicus.p1[83:267,],radius=0.2,col=2) #curves
spheres3d(subtropicus.p1[268:412,],radius=0.1,col=3) #patches
text3d(subtropicus.p1, texts = c(1:412), asp=FALSE, cex=1, col="blue", pos = 3 )
LMcoords <- t(read.csv('Antechinus_cranialvariation_data.csv', header = T, row.names = 1))
dim(LMcoords)
Ants <- arrayspecs(LMcoords, 82, 3)
dim(Ants)
Ahead <- head(dimnames(Ants))[3]
fixed<-as.matrix(subtropicus.p1[1:82,])
patch<-as.matrix(subtropicus.p1[c(83:267),])
Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = list(as.integer(83, c(84:86), c(87:89), c(90:92), c(93:95), 96, c(97:104), c(105:107), c(108:110), c(111:113), c(114:116), c(117:120), c(121:124), c(125:127), c(128:130), c(131:132), c(133:134), c(135:136), c(137:138), c(139:143), c(144:148), c(149:151), c(152:153), c(154:157), c(158:159), 160, 161, 162, 163, c(164:166), c(167:168), c(169:172), c(173:174), 175, 176, 177, 178, c(179:180), c(181:182), c(183:187), c(188:190), c(191:193), c(194:197), c(198:201), c(202:205), c(206:209), c(210:212), c(213:215), c(216:218), c(219:223), c(224:226), c(227:231), 232, 233, c(234:238), c(239:243), c(244:245), c(246:247), c(248:250), c(251:253), c(254:256), c(257:264), c(265:267))))
cols<-c("pink", "purple", "yellow", "green")
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE, cols = cols)
fixed<-as.matrix(subtropicus.p1[1:82,])
patch<-as.matrix(subtropicus.p1[c(83:163,165:267),])
Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = list(as.integer(83, c(84:86), c(87:89), c(90:92), c(93:95), 96, c(97:104), c(105:107), c(108:110), c(111:113), c(114:116), c(117:120), c(121:124), c(125:127), c(128:130), c(131:132), c(133:134), c(135:136), c(137:138), c(139:143), c(144:148), c(149:151), c(152:153), c(154:157), c(158:159), 160, 161, 162, 163, c(167:168), c(169:172), c(173:174), 175, 176, 177, 178, c(179:180), c(181:182), c(183:187), c(188:190), c(191:193), c(194:197), c(198:201), c(202:205), c(206:209), c(210:212), c(213:215), c(216:218), c(219:223), c(224:226), c(227:231), 232, 233, c(234:238), c(239:243), c(244:245), c(246:247), c(248:250), c(251:253), c(254:256), c(257:264), c(265:267))))
c(164:166),
c(164:166),
cols<-c("pink", "purple", "yellow", "green")
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE, cols = cols)
patch<-as.matrix(subtropicus.p1[c(83:163,167:267),])
Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = list(as.integer(83, c(84:86), c(87:89), c(90:92), c(93:95), 96, c(97:104), c(105:107), c(108:110), c(111:113), c(114:116), c(117:120), c(121:124), c(125:127), c(128:130), c(131:132), c(133:134), c(135:136), c(137:138), c(139:143), c(144:148), c(149:151), c(152:153), c(154:157), c(158:159), 160, 161, 162, 163, c(167:168), c(169:172), c(173:174), 175, 176, 177, 178, c(179:180), c(181:182), c(183:187), c(188:190), c(191:193), c(194:197), c(198:201), c(202:205), c(206:209), c(210:212), c(213:215), c(216:218), c(219:223), c(224:226), c(227:231), 232, 233, c(234:238), c(239:243), c(244:245), c(246:247), c(248:250), c(251:253), c(254:256), c(257:264), c(265:267))))
cols<-c("pink", "purple", "yellow", "green")
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE, cols = cols)
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE, cols = cols)
fixed<-as.matrix(subtropicus.p1[1:82,])
#patch<-as.matrix(subtropicus.p1[c(83:412),])
patch<-as.matrix(subtropicus.p1[c(257:264)]
Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = list(as.integer(c(257:264))))
Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = list(as.integer(c(257:264))))
cols<-c("pink", "purple", "yellow", "green")
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE, cols = cols)
## import meshes and points cloud
subtropicus.holo<-file2mesh('3Dmodels/Asubtropicus/J17407.ply',readcol=F,clean=T)
subtropicus.p<-(read.csv('Templatecoords.csv', header = F))
dim(subtropicus.p)
rownames(subtropicus.p)<-subtropicus.p$V1
subtropicus.p1 <- subtropicus.p[,-1]
#A <- arrayspecs(subtropicus.p1, 412, 3)
#dim(A)
#Ahead <- head(dimnames(A))[3]
#template.p<-A[,,1]
#antestspecs<-A[,,2:5]
shade3d(subtropicus.holo,col=8)
spheres3d(subtropicus.p1[1:82,],radius=0.3,col=1)#fixed. nb of landmark = (z-1)/3
spheres3d(subtropicus.p1[83:267,],radius=0.2,col=2) #curves
spheres3d(subtropicus.p1[268:412,],radius=0.1,col=3) #patches
text3d(subtropicus.p1, texts = c(1:412), asp=FALSE, cex=1, col="blue", pos = 3 )
LMcoords <- t(read.csv('Antechinus_cranialvariation_data.csv', header = T, row.names = 1))
dim(LMcoords)
Ants <- arrayspecs(LMcoords, 82, 3)
dim(Ants)
Ahead <- head(dimnames(Ants))[3]
fixed<-as.matrix(subtropicus.p1[1:82,])
#patch<-as.matrix(subtropicus.p1[c(83:412),])
patch<-as.matrix(subtropicus.p1[c(257:264)]
Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = list(as.integer(c(257:264))))
Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = list(as.integer(c(257:264))))
fixed<-as.matrix(subtropicus.p1[1:82,])
patch<-as.matrix(subtropicus.p1[c(257:264)]
patch<-as.matrix(subtropicus.p1[c(257:264)])
patch<-as.matrix(subtropicus.p1[c(257:264),])
Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = list(as.integer(c(257:264))))
cols<-c("pink", "purple", "yellow", "green")
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE, cols = cols)
#The below is code to take out a small subsample of the whole 3d array
Folder <- "C:/Users/pietro/Desktop/Pietro/Projects/Viacavaetal_Antechinus/Data/3Dmodels/AntechinusTest/"
#Navigate to folder with the subsample of ply files
Plylist <- sub(".ply", "", list.files(Folder))
matching <- match(dimnames(Ants)[[3]],Plylist)
for_patch_placing <-which (!is.na(matching)==TRUE)
#Make an array that includes only the specimens you have in your folder
data <-Ants[, , for_patch_placing]
dimnames(data)[[3]]
lmplacement<-placePatch(Atlas,data,path=Folder, inflate=3) #ray=TRUE for projection along surface normals instead of closest point
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE)
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE)
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE)
Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = list(as.integer(c(257:264))))
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE)
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE)
## import meshes and points cloud
subtropicus.holo<-file2mesh('3Dmodels/Asubtropicus/J17407.ply',readcol=F,clean=T)
subtropicus.p<-(read.csv('Templatecoords.csv', header = F))
dim(subtropicus.p)
rownames(subtropicus.p)<-subtropicus.p$V1
subtropicus.p1 <- subtropicus.p[,-1]
#A <- arrayspecs(subtropicus.p1, 412, 3)
#dim(A)
#Ahead <- head(dimnames(A))[3]
#template.p<-A[,,1]
#antestspecs<-A[,,2:5]
shade3d(subtropicus.holo,col=8)
spheres3d(subtropicus.p1[1:82,],radius=0.3,col=1)#fixed. nb of landmark = (z-1)/3
spheres3d(subtropicus.p1[83:267,],radius=0.2,col=2) #curves
spheres3d(subtropicus.p1[268:412,],radius=0.1,col=3) #patches
text3d(subtropicus.p1, texts = c(1:412), asp=FALSE, cex=1, col="blue", pos = 3 )
LMcoords <- t(read.csv('Antechinus_cranialvariation_data.csv', header = T, row.names = 1))
dim(LMcoords)
Ants <- arrayspecs(LMcoords, 82, 3)
dim(Ants)
Ahead <- head(dimnames(Ants))[3]
fixed<-as.matrix(subtropicus.p1[1:82,])
patch<-as.matrix(subtropicus.p1[c(257:264),])
Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = list(as.integer(c(257:264))))
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE)
Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = list(c(257:264)))
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE)
fixed<-as.matrix(subtropicus.p1[1:82,])
patch<-as.matrix(subtropicus.p1[83,])
fixed<-as.matrix(subtropicus.p1[1:82,])
patch<-as.matrix(subtropicus.p1[83,])
Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = list(83))
Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = list(as.integer(83)))
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE)
fixed<-as.matrix(subtropicus.p1[1:82,])
patch<-as.matrix(subtropicus.p1[83:89,])
Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = list(as.integer(83,c(84:86), c(87:89))))
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE)
# Declaration of rowindices of curves
SC1<-as.integer(83)
SC2<-as.integer(c(84:86))
SC3<-as.integer(c(87:89))
curves1<-list(SC1,SC2,SC3)
Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = curves1)
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE)
Atlas$patchCurves
fixed<-as.matrix(subtropicus.p1[1:82,])
patch<-as.matrix(subtropicus.p1[83:89,])
# Declaration of rowindices of curves
SC1<-as.integer(83)
SC2<-as.integer(c(84:86))
SC3<-as.integer(c(87:89))
curves1<-list(SC1,SC2,SC3)
Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = curves1)
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE)
?unlist
Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = unlist(curves1))
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE)
?lapply
#The below is code to take out a small subsample of the whole 3d array
Folder <- "C:/Users/pietro/Desktop/Pietro/Projects/Viacavaetal_Antechinus/Data/3Dmodels/AntechinusTest/"
#Navigate to folder with the subsample of ply files
Plylist <- sub(".ply", "", list.files(Folder))
matching <- match(dimnames(Ants)[[3]],Plylist)
for_patch_placing <-which (!is.na(matching)==TRUE)
#Make an array that includes only the specimens you have in your folder
data <-Ants[, , for_patch_placing]
dimnames(data)[[3]]
lmplacement<-placePatch(Atlas,data,path=Folder, inflate=3) #ray=TRUE for projection along surface normals instead of closest point
checkLM(lmplacement, path = Folder, atlas=Atlas)
patch<-as.matrix(subtropicus.p1[84:89,])
SC2<-as.integer(c(84:86))
SC3<-as.integer(c(87:89))
curves1<-list(SC2,SC3)
Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = curves1)
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE)
# Declaration of rowindices of curves
#SC1<-as.integer(83)
SC2<-as.integer(c(11,84:86,13))
SC3<-as.integer(c(13,87:89,10))
curves1<-list(SC2,SC3)
Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = curves1)
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE)
?createAtlas
Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = curves1)
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE)
Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = list(as.integer(83, c(84:86), c(87:89), c(90:92), c(93:95), 96, c(97:104), c(105:107), c(108:110), c(111:113), c(114:116), c(117:120), c(121:124), c(125:127), c(128:130), c(131:132), c(133:134), c(135:136), c(137:138), c(139:143), c(144:148), c(149:151), c(152:153), c(154:157), c(158:159), 160, 161, 162, 163, c(167:168), c(169:172), c(173:174), 175, 176, 177, 178, c(179:180), c(181:182), c(183:187), c(188:190), c(191:193), c(194:197), c(198:201), c(202:205), c(206:209), c(210:212), c(213:215), c(216:218), c(219:223), c(224:226), c(227:231), 232, 233, c(234:238), c(239:243), c(244:245), c(246:247), c(248:250), c(251:253), c(254:256), c(257:264), c(265:267))))
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE)
fixed<-as.matrix(subtropicus.p1[1:82,])
patch<-as.matrix(subtropicus.p1[83:412,])
Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = list(as.integer(83, c(84:86), c(87:89), c(90:92), c(93:95), 96, c(97:104), c(105:107), c(108:110), c(111:113), c(114:116), c(117:120), c(121:124), c(125:127), c(128:130), c(131:132), c(133:134), c(135:136), c(137:138), c(139:143), c(144:148), c(149:151), c(152:153), c(154:157), c(158:159), 160, 161, 162, 163, c(167:168), c(169:172), c(173:174), 175, 176, 177, 178, c(179:180), c(181:182), c(183:187), c(188:190), c(191:193), c(194:197), c(198:201), c(202:205), c(206:209), c(210:212), c(213:215), c(216:218), c(219:223), c(224:226), c(227:231), 232, 233, c(234:238), c(239:243), c(244:245), c(246:247), c(248:250), c(251:253), c(254:256), c(257:264), c(265:267))))
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE)
Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = list(as.integer(83, c(84:86), c(87:89), c(90:92), c(93:95), 96, c(97:104), c(105:107), c(108:110), c(111:113), c(114:116), c(117:120), c(121:124), c(125:127), c(128:130), c(131:132), c(133:134), c(135:136), c(137:138), c(139:143), c(144:148), c(149:151), c(152:153), c(154:157), c(158:159), 160, 161, 162, 163, c(167:168), c(169:172), c(173:174), 175, 176, 177, 178, c(179:180), c(181:182), c(183:187), c(188:190), c(191:193), c(194:197), c(198:201), c(202:205), c(206:209), c(210:212), c(213:215), c(216:218), c(219:223), c(224:226), c(227:231), 232, 233, c(234:238), c(239:243), c(244:245), c(246:247), c(248:250), c(251:253), c(254:256), c(257:264), c(265:267))))
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE)
fixed<-as.matrix(subtropicus.p1[1:82,])
patch<-as.matrix(subtropicus.p1[268:412,])
Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = list(as.integer(83, c(84:86), c(87:89), c(90:92), c(93:95), 96, c(97:104), c(105:107), c(108:110), c(111:113), c(114:116), c(117:120), c(121:124), c(125:127), c(128:130), c(131:132), c(133:134), c(135:136), c(137:138), c(139:143), c(144:148), c(149:151), c(152:153), c(154:157), c(158:159), 160, 161, 162, 163, c(167:168), c(169:172), c(173:174), 175, 176, 177, 178, c(179:180), c(181:182), c(183:187), c(188:190), c(191:193), c(194:197), c(198:201), c(202:205), c(206:209), c(210:212), c(213:215), c(216:218), c(219:223), c(224:226), c(227:231), 232, 233, c(234:238), c(239:243), c(244:245), c(246:247), c(248:250), c(251:253), c(254:256), c(257:264), c(265:267))))
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE)
patch<-as.matrix(subtropicus.p1[83:412,])
knitr::opts_knit$set(root.dir = 'C:/Users/pietro/Desktop/Pietro/Projects/Viacavaetal_Antechinus/Data', echo = TRUE)
library(Morpho)
library(rgl)
library(Rvcg)
library(geomorph)
setwd('C:/Users/pietro/Desktop/Pietro/Projects/Viacavaetal_Antechinus/Data')
## import meshes and points cloud
subtropicus.holo<-file2mesh('3Dmodels/Asubtropicus/J17407.ply',readcol=F,clean=T)
subtropicus.p<-(read.csv('Templatecoords.csv', header = F))
dim(subtropicus.p)
rownames(subtropicus.p)<-subtropicus.p$V1
subtropicus.p1 <- subtropicus.p[,-1]
#A <- arrayspecs(subtropicus.p1, 412, 3)
#dim(A)
#Ahead <- head(dimnames(A))[3]
#template.p<-A[,,1]
#antestspecs<-A[,,2:5]
shade3d(subtropicus.holo,col=8)
spheres3d(subtropicus.p1[1:82,],radius=0.3,col=1)#fixed. nb of landmark = (z-1)/3
spheres3d(subtropicus.p1[83:267,],radius=0.2,col=2) #curves
spheres3d(subtropicus.p1[268:412,],radius=0.1,col=3) #patches
text3d(subtropicus.p1, texts = c(1:412), asp=FALSE, cex=1, col="blue", pos = 3 )
LMcoords <- t(read.csv('Antechinus_cranialvariation_data.csv', header = T, row.names = 1))
dim(LMcoords)
Ants <- arrayspecs(LMcoords, 82, 3)
dim(Ants)
Ahead <- head(dimnames(Ants))[3]
fixed<-as.matrix(subtropicus.p1[1:82,])
patch<-as.matrix(subtropicus.p1[83:412,])
Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = list(as.integer(83, c(84:86), c(87:89), c(90:92), c(93:95), 96, c(97:104), c(105:107), c(108:110), c(111:113), c(114:116), c(117:120), c(121:124), c(125:127), c(128:130), c(131:132), c(133:134), c(135:136), c(137:138), c(139:143), c(144:148), c(149:151), c(152:153), c(154:157), c(158:159), 160, 161, 162, 163, c(164:166), c(167:168), c(169:172), c(173:174), 175, 176, 177, 178, c(179:180), c(181:182), c(183:187), c(188:190), c(191:193), c(194:197), c(198:201), c(202:205), c(206:209), c(210:212), c(213:215), c(216:218), c(219:223), c(224:226), c(227:231), 232, 233, c(234:238), c(239:243), c(244:245), c(246:247), c(248:250), c(251:253), c(254:256), c(257:264), c(265:267))))
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE)
#The below is code to take out a small subsample of the whole 3d array
Folder <- "C:/Users/pietro/Desktop/Pietro/Projects/Viacavaetal_Antechinus/Data/3Dmodels/AntechinusTest/"
#Navigate to folder with the subsample of ply files
Plylist <- sub(".ply", "", list.files(Folder))
matching <- match(dimnames(Ants)[[3]],Plylist)
for_patch_placing <-which (!is.na(matching)==TRUE)
#Make an array that includes only the specimens you have in your folder
data <-Ants[, , for_patch_placing]
dimnames(data)[[3]]
lmplacement<-placePatch(Atlas,data,path=Folder, inflate=3) #ray=TRUE for projection along surface normals instead of closest point
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE)
plotAtlas(Atlas, pt.size=0.2, point = "p", legend = TRUE)
plotAtlas(Atlas, pt.size=0.2, point = "p", legend = TRUE)
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE)
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE)
plotAtlas(Atlas, pt.size=0.2, point = "p", legend = TRUE)
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE)
plotAtlas(Atlas, pt.size=0.2, point = "p", legend = TRUE)
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE)
267-83
412-268
?abind
library(geomorph)
?abind
?rbind
install.packages("abind")
?abind
library(abind)
?abind
subtropicus.p
dim(subtropicus.p)
dim(subtropicus.p1)
template.pf <- subtropicus.p1[1:82,]
template.pc <- subtropicus.p1[83:267,]
template.pp <- subtropicus.p1[268:412,]
template.p <- abind(template.pf, template.pc, template.pp)
template.p <- abind(template.pf, template.pp, template.pc)
class(template.pc)
template.p <- rbind(template.pf, template.pp, template.pc)
template.p
attributes(template.p)
fixed<-as.matrix(template.p[1:82,])
patch<-as.matrix(template.p[83:412,])
#Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = curves1)
Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = list(as.integer(228, c(229:231),, c(232:234))))
#Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = curves1)
Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = list(as.integer(228, c(229:231), c(232:234))))
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE)
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE)
subtropicus.p<-(read.csv('Templatecoords.csv', header = F))
rownames(subtropicus.p)<-subtropicus.p$V1
subtropicus.p<-(read.csv('Templatecoords.csv', header = F))
subtropicus.holo<-file2mesh('3Dmodels/Asubtropicus/J17407.ply',readcol=F,clean=T)
knitr::opts_knit$set(root.dir = 'C:/Users/pietro/Desktop/Pietro/Projects/Viacavaetal_Antechinus/Data', echo = TRUE)
library(Morpho)
library(rgl)
library(Rvcg)
library(geomorph)
library(abind)
setwd('C:/Users/pietro/Desktop/Pietro/Projects/Viacavaetal_Antechinus/Data')
subtropicus.holo<-file2mesh('3Dmodels/Asubtropicus/J17407.ply',readcol=F,clean=T)
subtropicus.p<-(read.csv('Templatecoords.csv', header = F))
dim(subtropicus.p)
rownames(subtropicus.p)<-subtropicus.p$V1
subtropicus.p1 <- subtropicus.p[,-1]
template.pf <- subtropicus.p1[1:82,]
template.pc <- subtropicus.p1[83:267,]
template.pp <- subtropicus.p1[268:412,]
template.p <- rbind(template.pf, template.pp, template.pc)
fixed<-as.matrix(template.p[1:82,])
patch<-as.matrix(template.p[83:412,])
#Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = curves1)
Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = list(as.integer(228, c(229:231), c(232:234))))
plotAtlas(Atlas, pt.size=0.2, point = "s", legend = TRUE)
#Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = curves1)
Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = list(as.integer(228, c(229:231), c(232:234))))
#Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = curves1)
Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = list(as.integer(228, c(229:231), c(232:234))))
Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = list(as.integer(228, c(229:231), c(232:234))))
Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = list(as.integer(228, c(229:231), c(232:234))))
#Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = curves1)
Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = list(as.integer(228, c(229:231), c(232:234))))
#Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = curves1)
Atlas<-createAtlas(subtropicus.holo,landmarks=fixed,patch=patch, patchCurves = list(as.integer(228, c(229:231), c(232:234))))
knitr::opts_knit$set(root.dir = 'C:/Users/pietro/Desktop/Pietro/Projects/Viacavaetal_Antechinus/Data', echo = TRUE)
library(Morpho)
library(rgl)
library(Rvcg)
library(geomorph)
library(abind)
setwd('C:/Users/pietro/Desktop/Pietro/Projects/Viacavaetal_Antechinus/Data')
subtropicus.holo<-file2mesh('3Dmodels/Asubtropicus/J17407.ply',readcol=F,clean=T)
subtropicus.p<-(read.csv('Templatecoords.csv', header = F))
dim(subtropicus.p)
rownames(subtropicus.p)<-subtropicus.p$V1
subtropicus.p1 <- subtropicus.p[,-1]
template.pf <- subtropicus.p1[1:82,]
template.pc <- subtropicus.p1[83:267,]
template.pp <- subtropicus.p1[268:412,]
template.p <- rbind(template.pf, template.pp, template.pc)
fixed<-as.matrix(subtropicus.p1[1:82,])
View(fixed)
knitr::opts_knit$set(root.dir = 'C:/Users/pietro/Desktop/Pietro/Projects/Viacavaetal_Antechinus/Data', echo = TRUE)
library(Morpho)
library(rgl)
library(Rvcg)
library(geomorph)
library(abind)
setwd('C:/Users/pietro/Desktop/Pietro/Projects/Viacavaetal_Antechinus/Data')
subtropicus.holo<-file2mesh('3Dmodels/Asubtropicus/J17407.ply',readcol=F,clean=T)
subtropicus.holo<-file2mesh('3Dmodels/Asubtropicus/J17407.ply',readcol=F,clean=T)
