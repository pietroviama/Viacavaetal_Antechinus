col.gp <- colswes[match(gdfhallucatusminusisland$Population, names(colswes))] # magic!
head(col.gp) # see the result
#Import 3D coordinates from all specimens
coords.3D <- t (read.csv("Data/LMcoords_Dhallucatus.csv", header = TRUE, row.names = 1))
dim(coords.3D)
#Convert 2D metadata into a 3D array
A <- arrayspecs(coords.3D, 900, 3)
dim(A)
Ahead <- head(dimnames(A))[3]
#Load the classifier
quollsdata <- read.csv("C:/Users/pietro/Desktop/Pietro/Specimens/Dhallucatus_data.csv", header=T)
Data.pops <- quollsdata$Population
is.factor(Data.pops) # check that it is a factor
#give museum ID row names to quolls data
rownames(quollsdata)<-quollsdata$Museum_ID
####Rearrange coordinate names and classifier file names in the same order
names_array <- dimnames(A)[[3]]
names_classifier <- rownames(quollsdata)
match(names_array, names_classifier)
A_reorder <- A[,,match(names_classifier, names_array)]
names_Areorder <- dimnames(A_reorder)[[3]]
match(names_Areorder, names_classifier)
####DO THIS######
partialgpa <- procGPA(A_reorder, scale = FALSE, distances = TRUE)
shapesPCAplot <- plot(partialgpa$scores[,1], partialgpa$scores[,2], bg = quollsdata$Population, pch = 21, cex = 2)
legend("bottomright", legend=unique(quollsdata$Population), pch=19, col=unique(quollsdata$Population), cex=1.5)
#####DO THAT######
gpaall<-gpagen(A_reorder, curves = NULL, surfaces = NULL, PrinAxes = TRUE,
max.iter = NULL, ProcD = TRUE, Proj = TRUE, print.progress = TRUE)
#include precipitation and temperature data from worldclim
rclim<- getData("worldclim",var="bio",res=10) #run in console
rclim <- rclim[[c(1,12)]]
names(rclim) <- c("Temp","Prec")
lons <- quollsdata$Longitude
lats <- quollsdata$Latitude
coordsgps <- data.frame(lons, lats)
valuestemp <- extract(rclim,coordsgps)
dfwtemp <- cbind.data.frame(coordsgps,valuestemp)
dfwtemp
#frame data for geomorph
gdfall <- geomorph.data.frame(gpaall, Population = quollsdata$Population,
Sex = quollsdata$Sex, MuseumID = quollsdata$Museum_ID, Latitude = quollsdata$Latitude,
Longitude = quollsdata$Longitude, main_island = quollsdata$Island_Mainland, IBRA = quollsdata$IBRA_7_Regions,
Datcoll = quollsdata$Date_collected, conservationstatus = quollsdata$Conservation_status,
Aridity = quollsdata$Aridity_index, precipitation = quollsdata$Precipitation,
habitat = quollsdata$Forest_habitat, vegtype = quollsdata$Vegetation_type, climate = quollsdata$Climate_classification,
tempworldclim = dfwtemp$Prec, tempworldclim = dfwtemp$Temp, Species = quollsdata$Species)
Islmaindata <- Dhallucatusdata[-which(Dhallucatusdata$Island_Mainland=='unknown'),]
Islmaindata
Islmaindata1 <- droplevels(Islmaindata)
Islmaincoords <- A_reorder[,,-which(quollsdata$Island_Mainland=="unknown")]
dim(Islmaincoords)
gpaislmain<-gpagen(Islmaincoords, curves = NULL, surfaces = NULL, PrinAxes = TRUE,
max.iter = NULL, ProcD = TRUE, Proj = TRUE, print.progress = TRUE)
gdfislmain <- geomorph.data.frame(gpaislmain, Population = Islmaindata1$Population,
Sex = Islmaindata1$Sex, MuseumID = Islmaindata1$Museum_ID, Latitude = Islmaindata1$Latitude,
Longitude = Islmaindata1$Longitude, main_island = Islmaindata1$Island_Mainland, IBRA = Islmaindata1$IBRA_7_Regions,
Datcoll = Islmaindata1$Date_collected, conservationstatus = Islmaindata1$Conservation_status,
Aridity = Islmaindata1$Aridity_index, precipitation = Islmaindata1$Precipitation,
habitat = Islmaindata1$Forest_habitat, vegtype = Islmaindata1$Vegetation_type, climate = Islmaindata1$Climate_classification,
Species = Islmaindata1$Species)
gdfislmain <- geomorph.data.frame(gpaislmain, Population = Islmaindata1$Population,
Sex = Islmaindata1$Sex, MuseumID = Islmaindata1$Museum_ID, Latitude = Islmaindata1$Latitude,
Longitude = Islmaindata1$Longitude, main_island = Islmaindata1$Island_Mainland, IBRA = Islmaindata1$IBRA_7_Regions,
Datcoll = Islmaindata1$Date_collected, conservationstatus = Islmaindata1$Conservation_status,
Aridity = Islmaindata1$Aridity_index, precipitation = Islmaindata1$Precipitation,
habitat = Islmaindata1$Forest_habitat, vegtype = Islmaindata1$Vegetation_type, climate = Islmaindata1$Climate_classification,
Species = Islmaindata1$Species)
Islmaincoords <- A_reorder[,,-which(quollsdata$Island_Mainland=="unknown")]
dim(Islmaincoords)
dim(Islmaindata1)
Islmaindata <- Dhallucatusdata[-which(Dhallucatusdata$Island_Mainland=='unknown'),]
Islmaindata
Dhallucatusdata$Island_Mainland
fitmainisl <- procD.lm(gpahallucatus$coords~gpahallucatus$Island_Mainland)
fitmainisl <- procD.lm(gdfhallucatus$coords~gdfhallucatus$Island_Mainland)
gdfall$Population
Dhallucatuscoords <- A_reorder[,,-which(quollsdata$Population=="Other species")]
dim(Dhallucatuscoords)
Dhallucatusdata <- quollsdata[-which(quollsdata$Population=='Other species'),]
Dhallucatusdata
Dhallucatusdata <- droplevels(Dhallucatusdata)
dim(Dhallucatusdata)
dimnames(Dhallucatuscoords)[[3]]==rownames(Dhallucatusdata)
gpahallucatus<-gpagen(Dhallucatuscoords, curves = NULL, surfaces = NULL, PrinAxes = TRUE,
max.iter = NULL, ProcD = TRUE, Proj = TRUE, print.progress = TRUE)
gdfhallucatus <- geomorph.data.frame(gpahallucatus, Population = Dhallucatusdata$Population,
Sex = Dhallucatusdata$Sex, MuseumID = Dhallucatusdata$Museum_ID, Latitude = Dhallucatusdata$Latitude,
Longitude = Dhallucatusdata$Longitude, main_island = Dhallucatusdata$Island_Mainland, IBRA = Dhallucatusdata$IBRA_7_Regions,
Datcoll = Dhallucatusdata$Date_collected, conservationstatus = Dhallucatusdata$Conservation_status,
Aridity = Dhallucatusdata$Aridity_index, precipitation = Dhallucatusdata$Precipitation,
habitat = Dhallucatusdata$Forest_habitat, vegtype = Dhallucatusdata$Vegetation_type, climate = Dhallucatusdata$Climate_classification,
ppworldclim = Dhallucatusworldclim$Prec, tempworldclim = Dhallucatusworldclim$Temp, Species = Dhallucatusdata$Species)
fitsizeisl <- procD.lm(gpaislmain$Csize~Islmaindata1$Island_Mainland)
fitmainisl <- procD.lm(gdfhallucatus$coords~gdfhallucatus$Island_Mainland)
gdfhallucatus$coords
gdfhallucatus$main_island
fitmainisl <- procD.lm(gdfhallucatus$coords~gdfhallucatus$main_island)
gdfhallucatus$coords
gdfhallucatus$main_island
fitmainisl <- procD.lm(gdfhallucatus$coords~gdfhallucatus$main_island)
fitmainisl <- procD.lm(gdfhallucatus$coords~gdfhallucatus$main_island, data = gdfhallucatus)
fitmainisl <- procD.lm(gpahallucatus$coords~gdfhallucatus$main_island, data = gdfhallucatus)
str(gdfhallucatus)
str(gdfhallucatus$coords)
class(gdfhallucatus$coords)
gdfhallucatus <- geomorph.data.frame(gpahallucatus, Population = Dhallucatusdata$Population,
Sex = Dhallucatusdata$Sex, MuseumID = Dhallucatusdata$Museum_ID, Latitude = Dhallucatusdata$Latitude,
Longitude = Dhallucatusdata$Longitude, main_island = Dhallucatusdata$Island_Mainland, IBRA = Dhallucatusdata$IBRA_7_Regions,
Datcoll = Dhallucatusdata$Date_collected, conservationstatus = Dhallucatusdata$Conservation_status,
Aridity = Dhallucatusdata$Aridity_index, precipitation = Dhallucatusdata$Precipitation,
habitat = Dhallucatusdata$Forest_habitat, vegtype = Dhallucatusdata$Vegetation_type, climate = Dhallucatusdata$Climate_classification,
ppworldclim = Dhallucatusworldclim$Prec, tempworldclim = Dhallucatusworldclim$Temp, Species = Dhallucatusdata$Species)
class(gdfhallucatus)
class(gdfhallucatus$coords)
fitmainisl <- procD.lm(gdfhallucatus$coords~gdfhallucatus$main_island, data = gdfhallucatus)
fitmainisl <- procD.lm(coords~main_island, data = gdfhallucatus)
summary(fitmainisl)
fitsizeisl <- procD.lm(gpahallucatus$Csize~gdfhallucatus$Island_Mainland)
fitsizeisl <- procD.lm(gdfhallucatus$Csize~gdfhallucatus$Island_Mainland)
fitsizeisl <- procD.lm(Csize~main_island, data = gdfhallucatus)
summary(fitsizeisl)
boxord(gdfhallucatus$Csize, gdfhallucatus$main_island, FUN = mean, 15)
boxord<-function(x,factor,FUN=FUN,mag){
library(ggplot2)
x<-as.numeric(x)
factor<-as.factor(factor)
incrorder<-aggregate(x,by=list(factor),FUN=FUN)[order(aggregate(x,by=list(factor),FUN=FUN)[,2]),][,1]
incrord<-reorderbynewlevelsorder(x,factor,incrorder)
df<-data.frame(x=incrord$factor,y=incrord$matrix)
ggplot(df, aes(x=x, y=y)) +
geom_boxplot() +
theme(text=element_text(size=mag))+
stat_summary(fun.y=FUN, geom="line", aes(group=1))  +
stat_summary(fun.y=FUN, geom="point")
}
reorderbynewlevelsorder<-function(matrix,factor,newlevelsorder){
require(gdata)
character=newlevelsorder
matrix<-as.matrix(matrix)
phylomatch<-NULL
phylomatch<-match(character,levels(factor))
facmatch<-NULL
facmatch<-reorder.factor(factor,new.order=c(phylomatch))
newfactor<-NULL
newfactor<-facmatch[order(facmatch)]
varmatch<-NULL
if(ncol(matrix)>1){varmatch<-matrix[order(facmatch),]}else{varmatch<-matrix[order(facmatch)]}
newvariables<-list(matrix=varmatch,factor=newfactor)
return(newvariables)
}
boxord(gdfhallucatus$Csize, gdfhallucatus$main_island, FUN = mean, 15)
boxplot(gpaislmain$Csize~Islmaindata1$Island_Mainland)
boxplot(gdfhallucatus$Csize~gdfhallucatus$main_island)
boxplot(gdfhallucatus$Csize~gdfhallucatus$main_island)
boxord(gpadhallminusdolphin$Csize, Dhalldataminusdolphin$Population, FUN = mean, 15)
gdfhallucatus$Population
boxord(gdfhallucatus$Csize, gdfhallucatus$Population, FUN = mean, 15)
boxplot(gdfhallucatus$Csize~gdfhallucatus$Population)
boxord(gdfhallucatus$Csize, gdfhallucatus$Population, FUN = mean, 15)
boxplot(gdfhallucatus$Csize~gdfhallucatus$Population)
boxord(gdfhallucatus$Csize, gdfhallucatus$Population, FUN = mean, 15)
boxplot(gdfhallucatus$Csize~gdfhallucatus$Population)
boxord(gdfhallucatus$Csize, gdfhallucatus$main_island, FUN = mean, 15)
boxord(gdfhallucatus$Csize, gdfhallucatus$Population, FUN = mean, 15)
boxord(gdfhallucatus$Csize, gdfhallucatus$main_island, FUN = mean, 15)
?boxord
boxord(gdfhallucatus$Csize, gdfhallucatus$Population, FUN = mean, 15)
boxord(gpasex$Csize, Sexdata1$Sex, FUN = mean, 15)
boxplot(gpasex$Csize~Sexdata1$Sex, xlab="Sex", ylab="Centroid Size", col=c("lightblue","pink"), frame=F, ylim=c(500,800));
boxord(gpasex$Csize, Sexdata1$Sex, FUN = mean, 15)
boxplot(gpasex$Csize~Sexdata1$Sex, xlab="Sex", ylab="Centroid Size", col=c("lightblue","pink"), frame=F, ylim=c(500,800));
boxplot(gdfmainland$Csize~gdfmainland$Population)
boxplot(gdfmainland$Csize~gdfmainland$Population)
boxord(gdfmainland$Csize, gdfmainland$Population, FUN = mean, 15)
boxord(gdfmainland$Csize, gdfmainland$Population, FUN = mean, 15)
boxord(gdfmainland$Csize, gdfmainland$Population, xlab="Population," FUN = mean, 15)
boxord(gdfmainland$Csize, gdfmainland$Population, FUN = mean, 15)
boxord(gdfmainland$Csize, gdfmainland$Population, FUN = mean, 15)
boxord(gdfmainland$Csize, gdfmainland$Population, FUN = mean, 15, xlab="pop")
boxord(gdfmainland$Csize, gdfmainland$Population, FUN = mean, 15, col=c("red", "blue", "pink", "yellow"))
if(!require(devtools)) install.packages("devtools")
#Find the mean specimen
findMeanSpec(gpadhallminusdolphin$coords)
library(Morpho)
library(geomorph)
#Find the mean specimen
findMeanSpec(gpadhallminusdolphin$coords)
#Read the mean specimen, meanspec
meanspec <- read.ply("C:/Users/pietro/Desktop/Pietro/Specimens/QM/Dhallucatus_QM/Clean_meshes/J3611c.ply", ShowSpecimen = TRUE, addNormals = TRUE)
testspec <- read.ply("C:/Users/pietro/Desktop/Pietro/Specimens/QM/Dhallucatus_QM/Clean_meshes/J3853c.ply", ShowSpecimen = T)
data(nose)
longnose.mesh <- tps3d(shortnose.mesh, shortnose.lm, longnose.lm,threads=1)
?meshDist
## Not run:
mD <- meshDist(longnose.mesh, shortnose.mesh)
render(mD,rampcolors = c("white","red"))
meshDist(longnose.mesh, shortnose.mesh, rampcolors = c("blue", "red"),sign=FALSE, tol=0.5)
longnose.mesh <- tps3d(shortnose.mesh, shortnose.lm, longnose.lm,threads=1)
mD <- meshDist(longnose.mesh, shortnose.mesh)
source('C:/Users/pietro/Desktop/Pietro/Codes/warpingfigures.R')
pilio.p
map2 <-
map1+
geom_point(data=antechinusdata1,
aes(x=Longitude, y=Latitude, fill = Species, shape = Species), color="white", cex=4) +
scale_fill_manual(values = c("red", "blue"), labels=c("stuartii", "subtropicus"), name=NULL) +
scale_shape_manual(values = c(24,22), labels=c("stuartii", "subtropicus"), name=NULL) + # define shape/color scales
labs(x="Latitude", y="Longitude", title="Antechinus distribution map") + # label the axes
theme_bw() + theme(legend.position="bottom", axis.text = element_text(size = rel(0.75)), legend.key = element_rect(colour = "white"), axis.text.x = element_text(angle=45, vjust=0.5)) # tweak the plot's appearance and legend position
antechinusdata1 <- antechinusdata[-c(184,186),]
###############################################################################
###############################################################################
library(ggplot2)
library(maps)
library(plyr)
library(dplyr)
world_map <- map_data("world")
australia <- subset(world_map, world_map$region=="Australia")
australia
p <- ggplot() + coord_fixed() +
xlab("") + ylab("")
australia_messy <- p + geom_polygon(data=australia, aes(x=long, y=lat, group=group),
colour="black", fill="white")
australia_messy
cleanup <-
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_rect(fill = 'white', colour = 'white'),
axis.line = element_line(colour = "white"), legend.position="none",
axis.ticks=element_blank(), axis.text.x=element_blank(),
axis.text.y=element_blank())
australia_clean <- australia_messy + cleanup
australia_clean
#Load the classifier
antechinusdata <- read.csv("C:/Users/pietro/Desktop/Pietro/Projects/Viacavaetal_Antechinus/Data/Antechinus_cranialvariation_data.csv", header=T)
is.factor(antechinusdata$Species)
australiamap_data <-
australia_clean+
geom_point(data=antechinusdata,
aes(x=Longitude, y=Latitude, fill =Species)
,pch=21, size=4, alpha=I(0.7))+
theme(legend.position = c(1,0.8), legend.justification = c(0,1), legend.key = element_blank(), legend.title = element_text(size = 20),
legend.text = element_text(size = 18))+
labs(fill="Species")
australiamap_data
library(ggplot2)
library(ggmap)
library(maps)
antechinusdata1 <- antechinusdata[-c(184,186),]
range(antechinusdata$Longitude, na.rm = TRUE, finite = TRUE)
range(antechinusdata$Latitude, na.rm = TRUE, finite = TRUE)
base = get_map(location=c(145,-37,155,-25), zoom=7, maptype="terrain-background")
map1 = ggmap(base)
map1
map2 <-
map1+
geom_point(data=antechinusdata1,
aes(x=Longitude, y=Latitude, fill = Species, shape = Species), color="white", cex=4) +
scale_fill_manual(values = c("red", "blue"), labels=c("stuartii", "subtropicus"), name=NULL) +
scale_shape_manual(values = c(24,22), labels=c("stuartii", "subtropicus"), name=NULL) + # define shape/color scales
labs(x="Latitude", y="Longitude", title="Antechinus distribution map") + # label the axes
theme_bw() + theme(legend.position="bottom", axis.text = element_text(size = rel(0.75)), legend.key = element_rect(colour = "white"), axis.text.x = element_text(angle=45, vjust=0.5)) # tweak the plot's appearance and legend position
map2
```{r setup, include=FALSE}
knitr::opts_knit$set(root.dir = 'C:/Users/pietro/Desktop/Pietro/Specimens', echo = TRUE)
library(geomorph)
library(ggplot2)
library(vegan)
library(vegan)
if(!require(devtools)) install.packages("devtools")
library(devtools)
devtools::install_github("TGuillerme/landvR")
```{r load data}
#Import 3D coordinates from all specimens
coords.3D <- t (read.csv("Data/LMcoords_Dhallucatus.csv", header = TRUE, row.names = 1))
#Import 3D coordinates from all specimens
coords.3D <- t (read.csv("Data/LMcoords_Dhallucatus.csv", header = TRUE, row.names = 1))
```{r setup, include=FALSE}
knitr::opts_knit$set(root.dir = 'C:/Users/pietro/Desktop/Pietro/Specimens', echo = TRUE)
.Primitive("all")
#Import 3D coordinates from all specimens
coords.3D <- t (read.csv("Data/LMcoords_Dhallucatus.csv", header = TRUE, row.names = 1))
#Convert 2D metadata into a 3D array
A <- arrayspecs(coords.3D, 900, 3)
dim(A) #check dimensions of 3D array (number of specimens in z)
Ahead <- head(dimnames(A))[3] #specimen names
#Load the classifier
quollsdata <- read.csv("C:/Users/pietro/Desktop/Pietro/Specimens/Dhallucatus_data.csv", header=T)
Data.pops <- quollsdata$Population
is.factor(Data.pops) # check that it is a factor
#give museum ID row names to quolls data
rownames(quollsdata)<-quollsdata$Museum_ID
names_array <- dimnames(A)[[3]]
names_classifier <- rownames(quollsdata)
match(names_array, names_classifier)
A_reorder <- A[,,match(names_classifier, names_array)]
names_Areorder <- dimnames(A_reorder)[[3]]
match(names_Areorder, names_classifier)
Dhallucatuscoords <- A_reorder[,,-which(quollsdata$Population=="Other species")]
Dhallucatusdata <- quollsdata[-which(quollsdata$Population=='Other species'),]
Dhallucatusdata <- droplevels(Dhallucatusdata)
#check that specimens ID in coords array mirror specimen ID in classifier file
dimnames(Dhallucatuscoords)[[3]]==rownames(Dhallucatusdata)
#check that specimens ID in coords array mirror specimen ID in classifier file
dimnames(Dhallucatuscoords)[[3]]==rownames(Dhallucatusdata)
```{r Generalized Procrustes Analyses, extraction of climatic variables and dataframing for geomorph, include=TRUE}
gpahallucatus<-gpagen(Dhallucatuscoords, curves = NULL, surfaces = NULL, PrinAxes = TRUE,
max.iter = NULL, ProcD = TRUE, Proj = TRUE, print.progress = TRUE)
rclim<- getData("worldclim",var="bio",res=10) #run in console
names(rclim) <- c("Temp","Prec")
lons <- Dhallucatusdata$Longitude
lats <- Dhallucatusdata$Latitude
coordsgps <- data.frame(lons, lats)
valuestemp <- extract(rclim,coordsgps)
Dhallucatusworldclim <- cbind.data.frame(coordsgps,valuestemp)
gdfhallucatus <- geomorph.data.frame(gpahallucatus, Population = Dhallucatusdata$Population,
Sex = Dhallucatusdata$Sex, MuseumID = Dhallucatusdata$Museum_ID, Latitude = Dhallucatusdata$Latitude,
Longitude = Dhallucatusdata$Longitude, main_island = Dhallucatusdata$Island_Mainland, IBRA = Dhallucatusdata$IBRA_7_Regions,
Datcoll = Dhallucatusdata$Date_collected, conservationstatus = Dhallucatusdata$Conservation_status,
Aridity = Dhallucatusdata$Aridity_index, precipitation = Dhallucatusdata$Precipitation,
habitat = Dhallucatusdata$Forest_habitat, vegtype = Dhallucatusdata$Vegetation_type, climate = Dhallucatusdata$Climate_classification,
ppworldclim = Dhallucatusworldclim$Prec, tempworldclim = Dhallucatusworldclim$Temp, Species = Dhallucatusdata$Species)
rclim<- getData("worldclim",var="bio",res=10) #run in console
rclim <- rclim[[c(1,12)]]
names(rclim) <- c("Temp","Prec")
lons <- Dhallucatusdata$Longitude
lats <- Dhallucatusdata$Latitude
coordsgps <- data.frame(lons, lats)
valuestemp <- extract(rclim,coordsgps)
Dhallucatusworldclim <- cbind.data.frame(coordsgps,valuestemp)
gdfhallucatus <- geomorph.data.frame(gpahallucatus, Population = Dhallucatusdata$Population,
Sex = Dhallucatusdata$Sex, MuseumID = Dhallucatusdata$Museum_ID, Latitude = Dhallucatusdata$Latitude,
Longitude = Dhallucatusdata$Longitude, main_island = Dhallucatusdata$Island_Mainland, IBRA = Dhallucatusdata$IBRA_7_Regions,
Datcoll = Dhallucatusdata$Date_collected, conservationstatus = Dhallucatusdata$Conservation_status,
Aridity = Dhallucatusdata$Aridity_index, precipitation = Dhallucatusdata$Precipitation,
habitat = Dhallucatusdata$Forest_habitat, vegtype = Dhallucatusdata$Vegetation_type, climate = Dhallucatusdata$Climate_classification,
ppworldclim = Dhallucatusworldclim$Prec, tempworldclim = Dhallucatusworldclim$Temp, Species = Dhallucatusdata$Species)
Dhallminusisland<-Dhallucatuscoords[,,-which(Dhallucatusdata$Population=="island")]
Dhalldataminusisland <- Dhallucatusdata[-which(Dhallucatusdata$Population=="island"),]
Dhalldataminusisland<-droplevels(Dhalldataminusisland)
gpadhallminusisland <- gpagen(Dhallminusisland, curves = NULL, surfaces = NULL, PrinAxes = TRUE,
max.iter = NULL, ProcD = TRUE, Proj = TRUE, print.progress = TRUE)
rclim<- getData("worldclim",var="bio",res=10) #run in console
rclim <- rclim[[c(1,12)]]
names(rclim) <- c("Temp","Prec")
lons <- Dhalldataminusisland$Longitude
lats <- Dhalldataminusisland$Latitude
coordsgps <- data.frame(lons, lats)
valuestemp <- extract(rclim,coordsgps)
Dhallucatusworldclimminusisland <- cbind.data.frame(coordsgps,valuestemp)
gdfhallucatusminusisland <- geomorph.data.frame(gpadhallminusisland, Population = Dhalldataminusisland$Population,
Sex = Dhalldataminusisland$Sex, MuseumID = Dhalldataminusisland$Museum_ID, Latitude = Dhalldataminusisland$Latitude,
Longitude = Dhalldataminusisland$Longitude, main_island = Dhalldataminusisland$Island_Mainland, IBRA = Dhalldataminusisland$IBRA_7_Regions,
Datcoll = Dhalldataminusisland$Date_collected, conservationstatus = Dhalldataminusisland$Conservation_status,
Aridity = Dhalldataminusisland$Aridity_index, precipitation = Dhalldataminusisland$Precipitation,
habitat = Dhalldataminusisland$Forest_habitat, vegtype = Dhalldataminusisland$Vegetation_type, climate = Dhalldataminusisland$Climate_classification,
ppworldclim = Dhallucatusworldclimminusisland$Prec, tempworldclim = Dhallucatusworldclimminusisland$Temp, Species = Dhalldataminusisland$Species)
gdfhallucatusminusisland <- geomorph.data.frame(gpadhallminusisland, Population = Dhalldataminusisland$Population,
Sex = Dhalldataminusisland$Sex, MuseumID = Dhalldataminusisland$Museum_ID, Latitude = Dhalldataminusisland$Latitude,
Longitude = Dhalldataminusisland$Longitude, main_island = Dhalldataminusisland$Island_Mainland, IBRA = Dhalldataminusisland$IBRA_7_Regions,
Datcoll = Dhalldataminusisland$Date_collected, conservationstatus = Dhalldataminusisland$Conservation_status,
Aridity = Dhalldataminusisland$Aridity_index, precipitation = Dhalldataminusisland$Precipitation,
habitat = Dhalldataminusisland$Forest_habitat, vegtype = Dhalldataminusisland$Vegetation_type, climate = Dhalldataminusisland$Climate_classification,
ppworldclim = Dhallucatusworldclimminusisland$Prec, tempworldclim = Dhallucatusworldclimminusisland$Temp, Species = Dhalldataminusisland$Species)
```{r morpological disparity differences between island populations and mainland populations, include=TRUE}
morphol.disparity(coords ~ 1, groups= ~ main_island, data = gdfhallucatus, iter=499)
PCAminusisland <- plotTangentSpace(gdfhallucatusminusisland$coords, warpgrids = FALSE, mesh = FALSE, groups = gdfhallucatusminusisland$Population, legend = TRUE)
PCAminusisland <- plotTangentSpace(gdfhallucatusminusisland$coords, warpgrids = FALSE, mesh = FALSE, groups = gdfhallucatusminusisland$Population, legend = TRUE)
knitr::opts_knit$set(root.dir = '.../Specimens', echo = TRUE)
#load libraries
library(rgl)
library(rlang)
library(geomorph)
library(ggplot2)
library(raster)
library(vegan)
if(!require(devtools)) install.packages("devtools")
library(devtools)
devtools::install_github("TGuillerme/landvR")
library(landvR)
#Import 3D coordinates from all specimens
coords.3D <- t (read.csv(".../NquollShapeVariation_LMcoords.csv", header = TRUE, row.names = 1))
#Import 3D coordinates from all specimens
coords.3D <- t (read.csv(".../NquollShapeVariation_LMcoords.csv", header = TRUE, row.names = 1))
library(Morpho)
library(rgl)
library(Rvcg)
setwd('C:/Users/pietro/Desktop/Pietro/Projects/Viacavaetal_Antechinus/Data')
?t
subtropicus.holo<-file2mesh('3Dmodels/Asubtropicus/J17407.obj',readcol=F,clean=T)
subtropicus.p<-t(read.csv('Template_coords.csv', header = TRUE, row.names = 1))
shade3d(subtropicus.holo,col=8)
subtropicus.holo<-file2mesh('3Dmodels/Asubtropicus/J17407.obj',readcol=F,clean=T)
subtropicus.holo<-file2mesh('3Dmodels/Asubtropicus/J17407.ply',readcol=F,clean=T)
subtropicus.p<-t(read.csv('Template_coords.csv', header = TRUE, row.names = 1))
shade3d(subtropicus.holo,col=8)
dim(subtropicus.p)
A <- arrayspecs(subtropicus.p, 412, 3)
library(geomorph)
A <- arrayspecs(subtropicus.p, 412, 3)
subtropicus.p<-t(read.csv('Template_coords.csv', header = TRUE, row.names = 1))
dim(subtropicus.p)
A <- arrayspecs(subtropicus.p, 412, 3)
knitr::opts_knit$set(root.dir = 'C:/Users/pietro/Desktop/Pietro/Specimens', echo = TRUE)
#load libraries
library(ggplot2)
library(digest)
library(rgl)
library(geomorph)
library(vegan) # vegan version 2.4-4
library(Morpho)
library(ape)
library(raster)
library(sp)
library(MASS)
library(RColorBrewer)
library(shapes)
library(wesanderson)
library(magick)
gridpars=gridPar(pt.size=0.5, pt.bg="pink")
colswes <- wes_palette("Darjeeling1")
names(colswes) <- levels(gdfhallucatusminusisland$Population ) # assign levels to colours
col.gp <- colswes[match(gdfhallucatusminusisland$Population, names(colswes))] # magic!
head(col.gp) # see the result
#Import 3D coordinates from all specimens
coords.3D <- t (read.csv("Data/LMcoords_Dhallucatus.csv", header = TRUE, row.names = 1))
dim(coords.3D)
subtropicus.p<-t(read.csv('Template_coords.csv', header = TRUE, row.names = 1))
dim(subtropicus.p)
#Convert 2D metadata into a 3D array
A <- arrayspecs(coords.3D, 900, 3)
A <- arrayspecs(subtropicus.p, 412, 3)
subtropicus.p<-t(read.csv('Template_coords.csv', header = TRUE, row.names = 1))
dim(subtropicus.p)
A <- arrayspecs(subtropicus.p, 412, 3)
subtropicus.p<-t(read.csv('Template_coords.csv', header = TRUE, row.names = 1))
dim(subtropicus.p)
A <- arrayspecs(subtropicus.p, 412, 3)
?arrayspecs
subtropicus.p<-t(read.csv('LMcoordstest.csv', header = TRUE, row.names = 1))
dim(subtropicus.p)
A <- arrayspecs(subtropicus.p, 412, 3)
A <- arrayspecs(subtropicus.p, 82, 3)
dim(A)
Ahead <- head(dimnames(A))[3]
shade3d(subtropicus.holo,col=8)
spheres3d(subtropicus.p[1:40,],radius=0.5,col=1)#fixed
subtropicus.p<-t(read.csv('LMcoordstest.csv', header = TRUE, row.names = 1))
subtropicus.p<-t(read.csv('LMcoordstest.csv', header = TRUE, row.names = 1))
subtropicus.p<-t(read.csv('LMcoordstest.csv', header = TRUE, row.names = 1))
subtropicus.p<-t(read.csv('LMcoordstest.csv', header = TRUE)
subtropicus.p<-t(read.csv('LMcoordstest.csv', header = TRUE)
subtropicus.p<-t(read.csv('LMcoordstest.csv', header = TRUE))
subtropicus.p<-t(read.csv('LMcoordstest.csv', header = TRUE))
dim(subtropicus.p)
A <- arrayspecs(subtropicus.p, 412, 3)
dim(A)
Ahead <- head(dimnames(A))[3]
Ahead
A[,,1]
dim(A)
A[,,2]
template.p<-A[,,2]
shade3d(subtropicus.holo,col=8)
template.p<-A[,,2]
shade3d(subtropicus.holo,col=8)
spheres3d(template.p[145:227,],radius=0.5,col=1)#fixed
spheres3d(template.p[145:227,],radius=0.1,col=1)#fixed
shade3d(subtropicus.holo,col=8)
spheres3d(template.p[145:227,],radius=0.1,col=1)#fixed
shade3d(subtropicus.holo,col=8)
spheres3d(template.p[145:227,],radius=0.2,col=1)#fixed
A[1,,]
A[145,,]
A[144,,]
227+185
shade3d(subtropicus.holo,col=8)
spheres3d(template.p[145:227,],radius=0.3,col=1)#fixed
spheres3d(subtropicus.p[228:412,],radius=0.2,col=2) #curves
spheres3d(template.p[228:412,],radius=0.2,col=2) #curves
spheres3d(template.p[1:144,],radius=0.1,col=3) #patches
?symmetrize
81/3
246/3
324/3
rpm<-c(1:27)
lpm<-c(82:108)
pm<-cbind(rpm,lpm)
84/3
343/3
345/3
411/3
192/3
216/3
219/3
243/3
subtropicus.holo<-file2mesh('3Dmodels/Asubtropicus/J17407.ply',readcol=F,clean=T)
dim(template.p)
symme1<-Morpho::symmetrize(c(template.p[1:27,], template.p[82:108]),pm)#128
rpm<-c(1:27)
lpm<-c(82:108)
pm<-cbind(rpm,lpm)
rfp<-c(28:50)
lfp<-c(115:137)
fp<-cbind(rfp,lfp)
rn<-c(64:72)
ln<-c(73:81)
n<-cbind(rn,ln)
symme1<-Morpho::symmetrize(c(template.p[1:27,], template.p[82:108]),pm)#128
c(template.p[1:27,], template.p[82:108])
symme1<-Morpho::symmetrize(c(template.p[1:27,], template.p[82:108]),pm)#128
dim(c(template.p[1:27,], template.p[82:108]))
